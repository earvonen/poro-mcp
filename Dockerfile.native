# Stage 1: Build native image
FROM quay.io/quarkus/ubi-quarkus-mandrel-builder-image:jdk-21 AS build
WORKDIR /build
COPY pom.xml .
COPY src ./src
RUN mvn clean package -Dnative -DskipTests

# Stage 2: Runtime
FROM registry.access.redhat.com/ubi8/ubi-minimal:8.8
WORKDIR /app
RUN microdnf install -y java-21-openjdk-headless && microdnf clean all
COPY --from=build /build/target/*-runner /app/application

ENV JAVA_OPTS=""

ENTRYPOINT ["/app/application"]

